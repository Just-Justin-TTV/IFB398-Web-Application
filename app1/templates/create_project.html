{% extends 'base.html' %}
{% load static %}

{% block title %}Create Project - Carbon Management{% endblock %}

{% block page_title %}Create New Project{% endblock %}
{% block page_subtitle %}Add a project name, location, and type to get started{% endblock %}

{% block content %}
<div class="max-w-4xl">
    <!-- Django messages -->
    {% if messages %}
    <div class="mb-6 space-y-2">
        {% for message in messages %}
        <div class="rounded-lg px-4 py-3 text-sm
                    {% if message.tags == 'error' %} bg-red-50 text-red-700 border border-red-200
                    {% elif message.tags == 'success' %} bg-green-50 text-green-700 border border-green-200
                    {% else %} bg-blue-50 text-blue-700 border border-blue-200 {% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Form card -->
    <form id="projectForm" method="post" action="{% url 'create_project' %}" class="bg-white border rounded-2xl shadow-sm p-8">
        {% csrf_token %}

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="md:col-span-2">
                <label for="project_name" class="block text-sm font-medium text-gray-700 mb-2">Project Name <span class="text-red-500">*</span></label>
                <input id="project_name" name="project_name" type="text" required
                       placeholder="e.g. Pinecrest Logistics Hub"
                       class="w-full rounded-xl border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand/30 focus:border-brand">
            </div>

            <div>
                <label for="location" class="block text-sm font-medium text-gray-700 mb-2">Location</label>
                <input id="location" name="location" type="text" placeholder="e.g. Sydney, NSW"
                       class="w-full rounded-xl border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-brand/30 focus:border-brand">
            </div>

            <div>
                <label for="project_type" class="block text-sm font-medium text-gray-700 mb-2">Project Type <span class="text-red-500">*</span></label>
                <select id="project_type" name="project_type" required
                        class="w-full rounded-xl border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-brand/30 focus:border-brand">
                    <option value="" selected disabled>Select a type</option>
                    <option value="Residential">Residential</option>
                    <option value="Commercial">Commercial</option>
                    <option value="Industrial">Industrial</option>
                    <option value="Infrastructure">Infrastructure</option>
                    <option value="Mixed Use">Mixed Use</option>
                </select>
            </div>
        </div>

        <!-- Action buttons -->
        <div class="flex justify-end gap-3 mt-8 pt-6 border-t">
            <a href="{% url 'projects' %}"
               class="inline-flex items-center gap-2 rounded-full border border-gray-300 px-6 py-3 text-sm font-medium hover:bg-gray-50 transition-colors">
                Cancel
            </a>

            <button type="submit" id="nextBtn"
                    class="inline-flex items-center gap-2 rounded-full bg-brand px-6 py-3 text-white text-sm font-medium shadow-sm hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
                <span class="material-icons text-[18px]">arrow_forward</span>
                Next
            </button>
        </div>
    </form>
</div>

<script>
    // Simple client-side validation to enable/disable Next button
    (function () {
        const form = document.getElementById('projectForm');
        const nameEl = document.getElementById('project_name');
        const typeEl = document.getElementById('project_type');
        const nextBtn = document.getElementById('nextBtn');

        function validate() {
            const ok = nameEl.value.trim().length > 0 && typeEl.value.trim().length > 0;
            nextBtn.disabled = !ok;
        }
        nameEl.addEventListener('input', validate);
        typeEl.addEventListener('change', validate);
        validate();

        // Prevent double submit
        form.addEventListener('submit', function () {
            nextBtn.disabled = true;
            nextBtn.classList.add('opacity-60');
        });
    })();
</script>
{% endblock %}